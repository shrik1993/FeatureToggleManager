{% extends "app/layout.html" %}

{% load staticfiles %}
{% load jsonify %}

{% block scripts %}

{% if d_data %}
<script>
    $(document).ready(function () {
        
        // d_data should be jsonified by jsonify django filter.
        var t_data = JSON.parse({{ d_data |jsonify}});
        var csrf_token = '{{csrf_token|safe}}';
        datatotable_gen(t_data, 'admin_table', csrf_token);
    });
</script>
{% endif %}
{% endblock %}

{% block content %}
{% if user.is_superuser %}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9 col-md-10 main">
            <h1 class="page-header">{{dashboard_title}}</h1>
            <div class="container">
	            <form id="upload_form" action={% url 'uploadfile' %} method="post" class="form-horizontal" enctype="multipart/form-data">
                
                {% csrf_token %}
                <fieldset>
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div class="row">
                            <label class="control-label col-md-2 text-right" for="filename"><span>Import Excel File</span></label>
                            <div class="col-md-10">
                                <div class="input-group">
                                    <input type="hidden" id="filename" name="filename" value="">
                                    <input type="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" class="form-control" name="infile" />
                                    <div class="input-group-btn">
                                        <input type="submit" value="Upload" class="rounded-0 btn btn-primary">
                                    </div>
                                </div>
                                {% if uploaded_file_url %}
                                    <div class="alert alert-warning alert-dismissible">File Uploaded Successfully!
                                </div>
                                {% endif %}
                            </div>
                            </div>
                        </div>                        
                    </div>
                </fieldset>    
            </form>
        </div>
        </div>
    </div>
{% endif %}
    <div class="row">
        <h2 class="sub-header">Team-Wise Features</h2>
        <div class="table-responsive">
            <table id="admin_table" class="table table-striped table-bordered"></table>
        </div>
    </div>
</div>
{% endblock %}
